
# 비즈니스 요구사항과 설계
### (1) 회원<br>
  - 회원을 가입하고 조회<br>
  - 회원은 일반과 VIP 두 가지 등급이 있다.<br>
  - 회원 데이터는 자체 DB를 구축할 수 있고, - 외부 시스템과 연동할 수 있다.(미확정)<br>
<br>

### (2) 주문과 할인 정책<br>
- 회원은 상품을 주문할 수 있다.<br>
- 회원 등급에 따라 할인 정책을 적용할 수 있다.<br>
- 할인 정책은 모든 VIP는 1000원을 할인해주는 고정 금액 할인을 적용해달라. <br>(나중에 변경 될 수 있다.)<br>
- 할인 정책은 변경 가능성이 높다.<br>
-  회사의 기본 할인 정책을 아직 정하지 못했고, 오픈 직전까지 고민을 미루고 싶다.<br> 최악의 경우
 - 할인을 적용하지 않을 수도 있다. (미확정)
<br>
<br>


# 회원 도메인 설계
## 회원 도메인 협력관계
![회원 도메인 협력관계](https://user-images.githubusercontent.com/89888075/163079311-b80d4c2d-59e8-4318-8ba3-db98f2cb7f5b.PNG)
## 회원 클래스 다이어그램
![회원클레스 다이어그램](https://user-images.githubusercontent.com/89888075/163079314-3f706e84-bc1a-4344-9071-b91d689d0807.PNG)
## 회원 객체 다이어그램
![회원 객체 다이어그램](https://user-images.githubusercontent.com/89888075/163079306-acd0f7c4-8063-4e1b-a628-7e0eca0b9fe2.PNG)
<br>
<br>

# 회원 도메인 개발
> 회원 요구사항에 따른 필요 클래스및 인터페이스<br>
Member.class : DB 에 저장할 회원 정보 (회원 엔티티)<br>
grade.enum : 일반회원,VIP회원 을 나눌 enum<br>
MemberService.interface : 회원 서비스의 기능(역할)을 정한 인터페이스<br>
MeberServiceImpl.class : MemberService인터페이스의 구현체 회원가입과 회원조회의 기능을 구현<br>
MemberMemory.interface : DB의 기능(역할)을 정한 인터페이스<br>
MemoryMemberRepository : MemberMemory인터페이스의 구현체 (아직 어떤 DB를 사용할 지 정해지지않음)<br>



~~~java
package hello.core.member;
//회원등급
public enum grade {
    BASIC,VIP
}
~~~
~~~java
package hello.core.member;

//회원 엔티티
public class Member {

    private Long id;
    private String email;
    private String grade;

    public Member(Long id, String email, String grade) {
        this.id = id;
        this.email = email;
        this.grade = grade;
    }

    public Long getId() {
        return id;
    }

    public void setId(Long id) {
        this.id = id;
    }

    public String getEmail() {
        return email;
    }

    public void setEmail(String email) {
        this.email = email;
    }

    public String getGrade() {
        return grade;
    }

    public void setGrade(String grade) {
        this.grade = grade;
    }
}

~~~

~~~java
package hello.core.member;

//회원 저장소 인터페이스
public interface MemberRepository {
    void save(Member member);

    Member findId(Long MemberId);

}

~~~

~~~java
package hello.core.member;

import java.util.HashMap;
import java.util.Map;

//멤버레파지토리 구현체
public class MemoryMemberRepository implements MemberRepository{

    private static Map<Long, Member> store = new HashMap<>();
    //회원 요구사항에 아직 DB구축에대헤 미확정이여서 일단  단순한 회원 메모리인 Map의 구현체인 HashMap을 사용
    //Map이라는 인터페이스로 자바의 다형성을 이용해 언제든지 구현체를 바꿀수있도록 했다.

    @Override
    public void save(Member member){

    }

    @Override
    public Member findId(Long MemberId) {

        return null;
    }
}

~~~

~~~java
package hello.core.member;

// 회원 (기능)서비스 인터페이스
public interface MemberService {
  void 회원가입();
  void 회원조회();
}

~~~

~~~java
package hello.core.member;

//회원서비스 구현체
public class MemberServiceImpl implements MemberService{

    @Override
    public void 회원가입() {

    }

    @Override
    public void 회원조회() {

    }
}
~~~
<br>
<br>

# 회원 도메인 실행과 테스트
<br>
<br>

## 순수 자바코드 테스트

~~~java
package hello.core;

import hello.core.member.Grade;
import hello.core.member.Member;
import hello.core.member.MemberService;
import hello.core.member.MemberServiceImp;

public class MemberApp {
    //psvm 단축키
    public static void main(String[] args) {
        //테스트할 객체 MemberService 의 구현채 생성
        MemberService memberService = new MemberServiceImp();

        //가입시킬 멤버 정보 입력
        Member member = new Member(1L, "승빈", Grade.VIP);
        //변수 추출 단축키 control+alt+V
        memberService.회원가입(member);

        Member fMember = memberService.회원조회(1L);
// 단축키 soutv 변수 바로 출력
        System.out.println("member = " + member.getName());
        System.out.println("fMember = " + fMember.getName());

//지금코드는 스프링의 도움없이 순수 자바코드로만 만들어진 테스트 코드이며
        //main함수로 테스트하는거는 한게가 있기 때문에 JUnit 이라는 프레임워크를 사용한다.

    }
}
~~~
> 단축키 정리<br>
  public static void main(String[] args) {} = psvm <br>
  변수 추출 단축키  = control+alt+V <br>
  System.out.println("member = " + member.getName()); 변수 추출 = soutv<br>


### 실행(테스트)결과
![테스트결과1](https://user-images.githubusercontent.com/89888075/163139347-570a9623-50f3-4ed0-8747-3adbcaa8372a.PNG)
- 회원가입 정보와 회원조회의 결과가 같은지 테스트하는결과 이고 테스트결과 같게나와 테스트는 통과하였으나,<br>
  이 테스트는 순수 자바코드로만 만들어진 테스트 코드이여서 main함소로 일일이 콘솔창을 보며 <br>
  다 테스트하기에는 한계가 있기 때문에 **JUnit** 이라는 프레임워크를 사용하여 테스트 하자!

<br>
<br>

## JUnit Test

~~~java
package hello.core.member;


 import org.assertj.core.api.Assertions;
 import org.junit.jupiter.api.Test;

 public class MemberServiceTest {

    MemberService memberService = new MemberServiceImp();

    @Test
        void join(){
        //given = 이런게 주어진다.
        Member member = new Member(1L, "승빈", Grade.VIP);

        //when = 이럴때 
        memberService.회원가입(member);
        Member member1 = memberService.회원조회(1L);

        //then = 이렇게 된다.(검증)
         Assertions.assertThat(member).isEqualTo(member1);

    }
}
~~~
<br>
<br>

### junit테스트 결과
![junit테스트 결과1](https://user-images.githubusercontent.com/89888075/163141414-e84b7926-7646-4171-a4c7-2b5abe8357bd.PNG)

- Assertions이라는 검증 API를 이용해서 member와 member1이 같은지 확인한후 같으면 위와
같이 초록체크가되면서 테스트가 통과된다.

<br>
<br>

## 회원 도메인 설계의 문제점
~~~java
public class MemberServiceImp implements MemberService {

    MemberRepository memberRepository = new MemberMemoryRepository();
~~~
- 위 코드를 보면 MemberServiceImp클래스는 MemberRepository 인터페이스를 의존하고 MemberMemoryRepository 구현체도 의존한다.<br>
 MemberServiceImp클래스가 인터페이스를 의존하는건 상관없지만, MemberMemoryRepository라는 구현체를 의존한다는게
 문제가 된다.(추상화도의존하고 구체화에도 의존한다는 문제) 따라서 나중에 변경이있을 때 문제가된다.(**DIP위반**)<br>
 == **의존관계가 인터페이스 뿐만아니라 구현까지 모두 의존하는 문제점이 있다**.<br>
주문까지 만들고나서 문제점과 해결방안을 찾아보자!<br>

<br>
<br>

# 주문과 할인 도메인 설계

<br>
<br>

# 주문과 할인 도메인 개발

<br>
<br>

# 주문과 할인 도메인 실행과 테스트